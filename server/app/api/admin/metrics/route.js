"use strict";(()=>{var e={};e.id=7556,e.ids=[7556],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},6005:e=>{e.exports=require("node:crypto")},43735:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>I,patchFetch:()=>h,requestAsyncStorage:()=>l,routeModule:()=>m,serverHooks:()=>x,staticGenerationAsyncStorage:()=>g});var n={};r.r(n),r.d(n,{GET:()=>u,dynamic:()=>d});var s=r(49303),a=r(88716),i=r(60670),o=r(87070),c=r(81584),p=r(85662);let d="force-dynamic";async function u(e){try{let{userId:t}=await (0,c.I)();if(!t)return o.NextResponse.json({error:"Unauthorized"},{status:401});let r=e.nextUrl.searchParams.get("range")||"7d",n=new Date,s=new Date(n.getTime()-864e5*("1d"===r?1:"7d"===r?7:"30d"===r?30:90)),{data:a,error:i}=await p.O.from("generations").select("*").gte("created_at",s.toISOString()),{data:d,error:u}=await p.O.from("payments").select("*").gte("created_at",s.toISOString());(i||u)&&console.error("Error fetching metrics:",i||u);let m=a?.length||0,l=a?.filter(e=>e.image_url).length||0,g=m-l,x=d?.filter(e=>"completed"===e.status).length||0,I=new Set(a?.map(e=>e.user_id)||[]).size;return o.NextResponse.json({totalGenerations:m,successfulGenerations:l,failedGenerations:g,averageTime:15.5,totalUsers:I,blockingDetections:0,conversions:x,errors:g})}catch(e){return console.error("Metrics error:",e),o.NextResponse.json({error:"Internal server error"},{status:500})}}let m=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/admin/metrics/route",pathname:"/api/admin/metrics",filename:"route",bundlePath:"app/api/admin/metrics/route"},resolvedPagePath:"C:\\estudio-nexora-comet\\app\\api\\admin\\metrics\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:l,staticGenerationAsyncStorage:g,serverHooks:x}=m,I="/api/admin/metrics/route";function h(){return(0,i.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:g})}},85662:(e,t,r)=>{r.d(t,{O:()=>n});let n=(0,r(76429).eI)("https://mdngrazjggsunpvtwbam.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1kbmdyYXpqZ2dzdW5wdnR3YmFtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI1NjMyMDQsImV4cCI6MjA3ODEzOTIwNH0.EZD2ujsGnwUtz8rafZHOe8vDMOdoOcNYx8kBClqQxWs")}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[2510,1584,6628],()=>r(43735));module.exports=n})();