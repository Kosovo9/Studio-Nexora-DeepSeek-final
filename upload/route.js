"use strict";(()=>{var e={};e.id=5998,e.ids=[5998],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},6005:e=>{e.exports=require("node:crypto")},43632:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>x,patchFetch:()=>I,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m});var a={};t.r(a),t.d(a,{POST:()=>d});var o=t(49303),s=t(88716),n=t(60670),i=t(87070),p=t(85662),u=t(81584);async function d(e){try{let{userId:r}=await (0,u.I)();if(!r)return i.NextResponse.json({error:"Unauthorized"},{status:401});let{image:t,style:a}=await e.json(),o=t.replace(/^data:image\/\w+;base64,/,""),s=Buffer.from(o,"base64"),n=`${r}-${Date.now()}-${a}.jpg`,d=`generated/${n}`,{data:c,error:l}=await p.O.storage.from("images").upload(d,s,{contentType:"image/jpeg",upsert:!1});if(l)return console.error("Supabase upload error:",l),i.NextResponse.json({error:"Upload failed"},{status:500});let{data:{publicUrl:m}}=p.O.storage.from("images").getPublicUrl(d);return await p.O.from("generations").insert({user_id:r,image_url:m,style:a,created_at:new Date().toISOString()}),i.NextResponse.json({url:m})}catch(e){return console.error("Upload error:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/upload/route",pathname:"/api/upload",filename:"route",bundlePath:"app/api/upload/route"},resolvedPagePath:"C:\\estudio-nexora-comet\\app\\api\\upload\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:g}=c,x="/api/upload/route";function I(){return(0,n.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}},85662:(e,r,t)=>{t.d(r,{O:()=>a});let a=(0,t(76429).eI)("https://mdngrazjggsunpvtwbam.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1kbmdyYXpqZ2dzdW5wdnR3YmFtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI1NjMyMDQsImV4cCI6MjA3ODEzOTIwNH0.EZD2ujsGnwUtz8rafZHOe8vDMOdoOcNYx8kBClqQxWs")}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[2510,1584,6628],()=>t(43632));module.exports=a})();