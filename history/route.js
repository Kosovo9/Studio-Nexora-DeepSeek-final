"use strict";(()=>{var e={};e.id=2683,e.ids=[2683],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},6005:e=>{e.exports=require("node:crypto")},21668:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>y,patchFetch:()=>g,requestAsyncStorage:()=>m,routeModule:()=>l,serverHooks:()=>h,staticGenerationAsyncStorage:()=>x});var o={};r.r(o),r.d(o,{GET:()=>d,dynamic:()=>u});var s=r(49303),i=r(88716),n=r(60670),a=r(87070),p=r(81584),c=r(85662);let u="force-dynamic";async function d(e){try{let{userId:e}=await (0,p.I)();if(!e)return a.NextResponse.json({error:"Unauthorized"},{status:401});let{data:t,error:r}=await c.O.from("copilot_history").select("*").eq("user_id",e).order("created_at",{ascending:!1}).limit(50);if(r)return console.error("Error fetching copilot history:",r),a.NextResponse.json({messages:[]});let o=[];if(t)for(let e of t)o.push({id:e.id,role:"user",content:e.message,timestamp:new Date(e.created_at)}),o.push({id:e.id+"_response",role:"assistant",content:e.response,timestamp:new Date(e.created_at)});return o.sort((e,t)=>e.timestamp.getTime()-t.timestamp.getTime()),a.NextResponse.json({messages:o})}catch(e){return console.error("Copilot history error:",e),a.NextResponse.json({error:"Internal server error",details:e.message},{status:500})}}let l=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/copilot/history/route",pathname:"/api/copilot/history",filename:"route",bundlePath:"app/api/copilot/history/route"},resolvedPagePath:"C:\\estudio-nexora-comet\\app\\api\\copilot\\history\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:m,staticGenerationAsyncStorage:x,serverHooks:h}=l,y="/api/copilot/history/route";function g(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:x})}},85662:(e,t,r)=>{r.d(t,{O:()=>o});let o=(0,r(76429).eI)("https://mdngrazjggsunpvtwbam.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1kbmdyYXpqZ2dzdW5wdnR3YmFtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI1NjMyMDQsImV4cCI6MjA3ODEzOTIwNH0.EZD2ujsGnwUtz8rafZHOe8vDMOdoOcNYx8kBClqQxWs")}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[2510,1584,6628],()=>r(21668));module.exports=o})();