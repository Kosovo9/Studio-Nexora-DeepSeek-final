"use strict";(()=>{var e={};e.id=8194,e.ids=[8194],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},6005:e=>{e.exports=require("node:crypto")},34724:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>j,patchFetch:()=>A,requestAsyncStorage:()=>h,routeModule:()=>y,serverHooks:()=>f,staticGenerationAsyncStorage:()=>g});var s={};r.r(s),r.d(s,{POST:()=>d,dynamic:()=>p});var n=r(49303),o=r(88716),a=r(60670),i=r(87070),c=r(81584);let u=process.env.EMAIL_PROVIDER||"resend",p="force-dynamic";async function d(e){try{let t;let{userId:r}=await (0,c.I)(),{to:s,subject:n,html:o,text:a,from:p,replyTo:d,cc:y,bcc:h,attachments:g}=await e.json();if(!s||!n||!o)return i.NextResponse.json({error:"Missing required fields: to, subject, html"},{status:400});switch(u){case"resend":t=await m({to:s,subject:n,html:o,text:a,from:p,replyTo:d,cc:y,bcc:h,attachments:g});break;case"sendgrid":t=await l({to:s,subject:n,html:o,text:a,from:p,replyTo:d,cc:y,bcc:h,attachments:g});break;case"aws_ses":t=await x({to:s,subject:n,html:o,text:a,from:p,replyTo:d,cc:y,bcc:h,attachments:g});break;default:return i.NextResponse.json({error:`Unknown email provider: ${u}`},{status:400})}if(!t.success)return i.NextResponse.json({error:t.error||"Failed to send email"},{status:500});return i.NextResponse.json({success:!0,messageId:t.messageId})}catch(e){return console.error("Email send error:",e),i.NextResponse.json({error:"Internal server error",details:e.message},{status:500})}}async function m(e){let t=process.env.RESEND_API_KEY;if(!t)return{success:!1,error:"RESEND_API_KEY not configured"};try{let r=await fetch("https://api.resend.com/emails",{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({from:e.from||process.env.EMAIL_FROM||"noreply@studio-nexora.com",to:Array.isArray(e.to)?e.to:[e.to],subject:e.subject,html:e.html,text:e.text,reply_to:e.replyTo,cc:e.cc,bcc:e.bcc,attachments:e.attachments})}),s=await r.json();if(!r.ok)return{success:!1,error:s.message||"Resend API error"};return{success:!0,messageId:s.id}}catch(e){return{success:!1,error:e.message}}}async function l(e){let t=process.env.SENDGRID_API_KEY;if(!t)return{success:!1,error:"SENDGRID_API_KEY not configured"};try{let r=await fetch("https://api.sendgrid.com/v3/mail/send",{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({from:{email:e.from||process.env.EMAIL_FROM||"noreply@studio-nexora.com"},personalizations:[{to:Array.isArray(e.to)?e.to.map(e=>({email:e})):[{email:e.to}],subject:e.subject,cc:e.cc?.map(e=>({email:e})),bcc:e.bcc?.map(e=>({email:e}))}],content:[{type:"text/html",value:e.html},...e.text?[{type:"text/plain",value:e.text}]:[]],attachments:e.attachments?.map(e=>({content:"string"==typeof e.content?e.content:e.content.toString("base64"),filename:e.filename,type:e.type||"application/octet-stream",disposition:"attachment"}))})});if(!r.ok){let e=await r.text();return{success:!1,error:e||"SendGrid API error"}}return{success:!0,messageId:r.headers.get("x-message-id")||"unknown"}}catch(e){return{success:!1,error:e.message}}}async function x(e){return{success:!1,error:"AWS SES integration not yet implemented"}}let y=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/email/send/route",pathname:"/api/email/send",filename:"route",bundlePath:"app/api/email/send/route"},resolvedPagePath:"C:\\estudio-nexora-comet\\app\\api\\email\\send\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:h,staticGenerationAsyncStorage:g,serverHooks:f}=y,j="/api/email/send/route";function A(){return(0,a.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:g})}},49303:(e,t,r)=>{e.exports=r(30517)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[2510,1584],()=>r(34724));module.exports=s})();